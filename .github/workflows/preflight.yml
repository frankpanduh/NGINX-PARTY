name: 🐼 NGINX-PARTY Preflight 🚀

on:
  workflow_dispatch:

jobs:
  preflight:
    runs-on: ubuntu-latest

    steps:
      - name: ⚡ Checkout repo
        uses: actions/checkout@v4
        with:
          submodules: recursive

      - name: 🛠️ Check System Environment
        run: |
          echo "Checking system info..."
          uname -a
          lsb_release -a || echo "No lsb_release"
          df -h
          free -m
          echo "Checking essential tools..."
          for cmd in git wget curl make gcc cmake autoconf automake pkg-config lua5.3; do
            command -v $cmd || echo "⚠️ $cmd missing"
          done
          echo "Checking optional dependencies..."
          for lib in libpcre3-dev libpcre2-dev libxml2-dev libcurl4-openssl-dev \
                     libyajl-dev liblmdb-dev libgeoip-dev; do
            dpkg -s $lib &>/dev/null && echo "✅ $lib installed" || echo "⚠️ $lib missing"
          done

      - name: 🎉 Preflight complete
        run: echo "All clear for ninja-panda build! 🐼🚀"
