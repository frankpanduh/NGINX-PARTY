name: 🛠️ PANDUH-PARTY Preflight Checks

on:
  workflow_dispatch:
  push:
    branches: [main]

jobs:
  preflight:
    runs-on: ubuntu-latest
    steps:
      - name: 🔍 Checkout Repository
        uses: actions/checkout@v4
        with:
          submodules: recursive

      - name: 🧰 Install Base Dependencies
        run: |
          sudo apt-get update
          sudo apt-get install --no-install-recommends -y \
            build-essential \
            git \
            curl \
            wget \
            ca-certificates \
            libpcre3-dev \
            zlib1g-dev \
            libssl-dev \
            libxml2-dev \
            libxslt1-dev \
            libgeoip-dev \
            liblua5.3-dev \
            libcurl4-openssl-dev \
            libyajl-dev \
            cmake \
            pkg-config \
            ccache \
            lsb-release \
            debhelper \
            dh-autoreconf
          sudo rm -rf /var/lib/apt/lists/*

      - name: ✅ Preflight Complete
        run: echo "All dependencies installed and ready 🚀"